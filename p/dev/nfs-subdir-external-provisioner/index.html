<!doctype html><html lang=ko-kr dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="OCI ë¸”ë¡ ë³¼ë¥¨ ìµœì†Œ í¬ê¸° ì œí•œ í•´ê²°í•˜ê¸°"><title>Nfs subdir external provisioner</title><link rel=canonical href=https://blog.ayteneve93.com/p/dev/nfs-subdir-external-provisioner/><link rel=stylesheet href=/scss/style.min.6a692fd055deae459f2a9767f57f3855ba80cafd5041317f24f7360f6ca47cdf.css><meta property='og:title' content="Nfs subdir external provisioner"><meta property='og:description' content="OCI ë¸”ë¡ ë³¼ë¥¨ ìµœì†Œ í¬ê¸° ì œí•œ í•´ê²°í•˜ê¸°"><meta property='og:url' content='https://blog.ayteneve93.com/p/dev/nfs-subdir-external-provisioner/'><meta property='og:site_name' content='ApexCaptainì˜ ê¸°ìˆ  ë¸”ë¡œê·¸'><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='Kubernetes'><meta property='article:tag' content='OCI'><meta property='article:tag' content='NFS'><meta property='article:tag' content='StorageClass'><meta property='article:tag' content='PVC'><meta property='article:published_time' content='2025-10-04T00:00:00+09:00'><meta property='article:modified_time' content='2025-10-04T00:00:00+09:00'><meta property='og:image' content='https://blog.ayteneve93.com/p/dev/nfs-subdir-external-provisioner/images/cover.png'><meta name=twitter:title content="Nfs subdir external provisioner"><meta name=twitter:description content="OCI ë¸”ë¡ ë³¼ë¥¨ ìµœì†Œ í¬ê¸° ì œí•œ í•´ê²°í•˜ê¸°"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content='https://blog.ayteneve93.com/p/dev/nfs-subdir-external-provisioner/images/cover.png'><link rel="shortcut icon" href=/favicon.png></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="ë©”ë‰´ ì—¬ë‹«ê¸°">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu_7c3bd1d4d98bb2c4.png width=300 height=298 class=site-logo loading=lazy alt=Avatar>
</a><span class=emoji>ğŸ‘‹</span></figure><div class=site-meta><h1 class=site-name><a href=/>ApexCaptainì˜ ê¸°ìˆ  ë¸”ë¡œê·¸</a></h1><h2 class=site-description></h2></div></header><ol class=menu-social><li><a href=https://github.com/ApexCaptain target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li><a href=/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>ë‹¤í¬ ëª¨ë“œ</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">ëª©ì°¨</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#ë¬¸ì œì˜-ì‹œì‘>ë¬¸ì œì˜ ì‹œì‘</a><ol><li><a href=#oci-instancenodeì˜-boot-volume-ìµœì†Œê°’-ì œí•œ>OCI Instance(Node)ì˜ Boot Volume ìµœì†Œê°’ ì œí•œ</a></li><li><a href=#persistent-volumeë„-ë§ˆì°¬ê°€ì§€>Persistent Volumeë„ ë§ˆì°¬ê°€ì§€</a></li></ol></li><li><a href=#í•´ê²°ë°©ì•ˆ>í•´ê²°ë°©ì•ˆ</a><ol><li><a href=#nodepoolì˜-ìŠ¤í™-ë°-ìˆ˜-ì¡°ì •>NodePoolì˜ ìŠ¤í™ ë° ìˆ˜ ì¡°ì •</a></li><li><a href=#ì‹œìŠ¤í…œ-êµ¬ì„±-ìš”ì†Œ>ì‹œìŠ¤í…œ êµ¬ì„± ìš”ì†Œ</a></li><li><a href=#ì‚¬ìš©í•˜ëŠ”-ë„êµ¬>ì‚¬ìš©í•˜ëŠ” ë„êµ¬</a></li><li><a href=#terraform-ì¸í”„ë¼-êµ¬ì„±>Terraform ì¸í”„ë¼ êµ¬ì„±</a><ol><li><a href=#oci-ë¸”ë¡-ë³¼ë¥¨>OCI ë¸”ë¡ ë³¼ë¥¨</a></li><li><a href=#ë³¼ë¥¨-ë°±ì—…-ì •ì±…>ë³¼ë¥¨ ë°±ì—… ì •ì±…</a></li><li><a href=#ë°±ì—…-ì •ì±…-í• ë‹¹>ë°±ì—… ì •ì±… í• ë‹¹</a></li><li><a href=#ë³€ìˆ˜-ì •ì˜>ë³€ìˆ˜ ì •ì˜</a></li><li><a href=#ì¶œë ¥ê°’-ì •ì˜>ì¶œë ¥ê°’ ì •ì˜</a></li><li><a href=#ë³€ìˆ˜-íŒŒì¼-ìƒì„±>ë³€ìˆ˜ íŒŒì¼ ìƒì„±</a></li><li><a href=#terraform-ë°°í¬>Terraform ë°°í¬</a></li></ol></li><li><a href=#k8s-manifest>k8s Manifest</a><ol><li><a href=#ë„¤ì„ìŠ¤í˜ì´ìŠ¤-ìƒì„±>ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ìƒì„±</a></li><li><a href=#persistentvolume-ìƒì„±>PersistentVolume ìƒì„±</a></li><li><a href=#persistentvolumeclaim-ìƒì„±>PersistentVolumeClaim ìƒì„±</a></li><li><a href=#configmap-podì˜-sftp-ì»¨í…Œì´ë„ˆìš©-ssh-í‚¤-ê´€ë¦¬-ì„ íƒì‚¬í•­>ConfigMap (Podì˜ SFTP ì»¨í…Œì´ë„ˆìš© SSH í‚¤ ê´€ë¦¬, ì„ íƒì‚¬í•­)</a></li><li><a href=#service-ìƒì„±>Service ìƒì„±</a></li><li><a href=#deployment-ìƒì„±>Deployment ìƒì„±</a></li><li><a href=#filebrowser-ingress-êµ¬ì„±-ì„ íƒ>FileBrowser Ingress êµ¬ì„± (ì„ íƒ)</a></li><li><a href=#k8s-ë¦¬ì†ŒìŠ¤-ë°°í¬>k8s ë¦¬ì†ŒìŠ¤ ë°°í¬</a></li></ol></li><li><a href=#helm>Helm</a><ol><li><a href=#helm-ì €ì¥ì†Œ-ì¶”ê°€>Helm ì €ì¥ì†Œ ì¶”ê°€</a></li><li><a href=#nfs-subdir-external-provisioner-values-íŒŒì¼>NFS Subdir External Provisioner Values íŒŒì¼</a></li><li><a href=#helm-chart-ë°°í¬>Helm Chart ë°°í¬</a></li></ol></li><li><a href=#ê²€ì¦-ë°-í…ŒìŠ¤íŠ¸>ê²€ì¦ ë° í…ŒìŠ¤íŠ¸</a><ol><li><a href=#ë¦¬ì†ŒìŠ¤-ìƒíƒœ-í™•ì¸>ë¦¬ì†ŒìŠ¤ ìƒíƒœ í™•ì¸</a></li></ol></li></ol></li><li><a href=#ë§ˆì¹˜ë©°>ë§ˆì¹˜ë©°</a></li><li><a href=#ì¶”í›„-ê³„íš>ì¶”í›„ ê³„íš</a></li></ol></nav></div></section></aside><main class="main full-width"><article class="has-image main-article"><header class=article-header><div class=article-image><a href=/p/dev/nfs-subdir-external-provisioner/><img src=/p/dev/nfs-subdir-external-provisioner/images/cover_hu_341d9b11fcfb35a6.png srcset="/p/dev/nfs-subdir-external-provisioner/images/cover_hu_341d9b11fcfb35a6.png 800w, /p/dev/nfs-subdir-external-provisioner/images/cover_hu_139cdeac6a9cfe85.png 1600w" width=800 height=336 loading=lazy alt="Featured image of post Nfs subdir external provisioner"></a></div><div class=article-details><header class=article-category><a href=/categories/development/>Development</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/dev/nfs-subdir-external-provisioner/>Nfs subdir external provisioner</a></h2><h3 class=article-subtitle>OCI ë¸”ë¡ ë³¼ë¥¨ ìµœì†Œ í¬ê¸° ì œí•œ í•´ê²°í•˜ê¸°</h3></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>10ì›” 04, 2025</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>8 ë¶„ ì •ë„</time></div></footer></div></header><section class=article-content><h1 id=ì—°ê´€-í¬ìŠ¤íŠ¸>ì—°ê´€ í¬ìŠ¤íŠ¸</h1><ul><li><a class=link href=../oracle-cloud-infrastructure/>Oracle Cloud Infrastructure</a></li></ul><br><h2 id=ë¬¸ì œì˜-ì‹œì‘>ë¬¸ì œì˜ ì‹œì‘</h2><h3 id=oci-instancenodeì˜-boot-volume-ìµœì†Œê°’-ì œí•œ>OCI Instance(Node)ì˜ Boot Volume ìµœì†Œê°’ ì œí•œ</h3><p><a class=link href=https://www.oracle.com/kr/cloud/free/#always-free target=_blank rel=noopener>OCI Free Tier</a>ì— ë”°ë¥´ë©´ OKEì—ì„œ ê°€ìš©í•  ìˆ˜ ìˆëŠ” ìì›ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.</p><ol><li>CPU : 4ê°œ</li><li>ë©”ëª¨ë¦¬ : 24GB</li><li>ë¸”ë¡ ìŠ¤í† ë¦¬ì§€ : 200GB</li></ol><p>ì´ì— ë§ì¶° Terraformìœ¼ë¡œ OKE í´ëŸ¬ìŠ¤í„°ì™€ 4ê°œì˜ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ê°€ì§€ëŠ” ARM Node Poolì„ ìƒì„±í–ˆë‹¤.</p><p>ê° NodeëŠ” 1ê°œì˜ CPUì™€ 6GBì˜ ë©”ëª¨ë¦¬ë¥¼ ê°€ì§„ë‹¤.</p><p>ìŠ¤í† ë¦¬ì§€ì˜ ê²½ìš° ì¶”í›„ PVC ìƒì„±ì„ ìœ„í•´ì„œë„ ì“°ì´ë¯€ë¡œ ìµœëŒ€í•œ ì‘ê²Œ ì¡ì•„ì£¼ë ¤ê³  í–ˆë‹¤.</p><p align=center><img src=images/storage-plan-1.png alt>
<em>Nodeì—ëŠ” ìµœì†Œí•œì˜ ìš©ëŸ‰ë§Œ, ë‚˜ë¨¸ì§€ ëŒ€ë¶€ë¶„ì€ PVCë¡œ í• ë‹¹</em></p><br><p>ê·¸ëŸ°ë° ì‹¤ì œë¡œ ìƒì„±ëœ Instanceì˜ ì •ë³´ë¥¼ ë³´ë‹ˆ Boot Volumeì´ ë¹„ì •ìƒì ìœ¼ë¡œ í¬ê²Œ ë§Œë“¤ì–´ì ¸ ìˆë‹¤.</p><p align=center><img src=images/instance-detail.png alt>
<em>k8s Nodeì˜ ì—­í• ì„ í•˜ëŠ” Oracle Instance ì¤‘ í•˜ë‚˜ì˜ Boot Volume ì •ë³´</em></p><p>Boot Volumeì€ ë¬¸ì ê·¸ëŒ€ë¡œ Linux ì‹œìŠ¤í…œì´ ë¶€íŒ…í•˜ëŠ”ë° í•„ìš”í•œ ê¸°ë³¸ ë””ìŠ¤í¬ë¡œ, ìœˆë„ìš°ë¡œ ì¹˜ë©´ Cë“œë¼ì´ë¸Œ ê°™ì€ ì¡´ì¬ì´ë‹¤.</p><p>í™•ì¸ ê²°ê³¼, ë‹¤ìŒê³¼ ê°™ì€ ì´ìŠˆê°€ ë°œìƒí–ˆë‹¤.</p><ul><li><p>Instanceì˜ Boot Volumeì˜ í¬ê¸°ëŠ” <code>ìµœì†Œ 47Gi (50GB) ì´ìƒ</code> í• ë‹¹í•´ì¤˜ì•¼ í•œë‹¤.</p></li><li><p>ë‹¹ì—°íˆ ì´ ìš©ëŸ‰ì€ Free Tierì—ì„œ ì œê³µë˜ëŠ” <code>200GBì—ì„œ ì°¨ê°</code>ëœë‹¤.</p></li><li><p>ì´ëŸ¬ë©´ ë‹¨ìˆœíˆ Node 4ê°œë¥¼ ë§Œë“œëŠ” ê²ƒë§Œìœ¼ë¡œë„ Free Tierì˜ 200GBë¥¼ ë‹¤ ì¨ë²„ë¦¬ê²Œ ëœë‹¤.</p><p align=center><img src=images/storage-plan-2.png alt>
<em>ë‹¨ 1ê°œì˜ PVCë„ ìƒì„±í•  ìˆ˜ ì—†ë‹¤.</em></p></li></ul><p><br><br></p><h3 id=persistent-volumeë„-ë§ˆì°¬ê°€ì§€>Persistent Volumeë„ ë§ˆì°¬ê°€ì§€</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>PersistentVolumeClaim</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>my-pvc</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>storageClassName</span><span class=p>:</span><span class=w> </span><span class=l>oci-bv</span><span class=w> </span><span class=c>#OCIì—ì„œ ê¸°ë³¸ì ìœ¼ë¡œ ì œê³µí•˜ëŠ” Storage Class</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>accessModes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=l>ReadWriteOnce</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>resources</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>requests</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>storage</span><span class=p>:</span><span class=w> </span><span class=l>100Mi </span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>ì´ì²˜ëŸ¼ OKE k8s í´ëŸ¬ìŠ¤í„°ì— pvc í•˜ë‚˜ë¥¼ ë§Œë“ ë‹¤ê³  ê°€ì •í•´ë³´ì.<br><code>oci-bv</code>ëŠ” Oracleì—ì„œ ê¸°ë³¸ì ìœ¼ë¡œ ì œê³µë˜ëŠ” Storage classë¡œ OCI Block Volumeì„ ì €ì¥ì†Œë¡œ ì“´ë‹¤.</p><p>ì•½ 100MB ì •ë„ì˜ í¬ê¸°ë¥¼ ê°€ì§€ëŠ” ì‘ì€ PVCì´ë‹¤. ê·¸ëŸ¼ ì‹¤ì œ ë§Œë“¤ì–´ì§€ëŠ” OCI Block Volumeì˜ í¬ê¸°ë„ 100MB ì •ë„ì—¬ì•¼ í•˜ì§€ ì•Šì„ê¹Œ?</p><p>ì–´ë¦¼ë„ ì—†ë‹¤. ì—¬ê¸°ë„ í¬ê¸° ì œì•½ì´ ê±¸ë ¤ìˆì–´ì„œ <code>ìµœì†Œ 47Gi (50GB) ì´ìƒ</code>ì„ í• ë‹¹í•´ì¤˜ì•¼ í•œë‹¤.</p><blockquote><p><strong>ê·¹ë‹¨ì ìœ¼ë¡œ Nodeë¥¼ 1ê°œë§Œ ì“´ë‹¤ê³  ê°€ì •í•´ë„, PVCëŠ” 3ê°œê°€ í•œê³„ì´ë‹¤. ê°ê° 50GBì”©&mldr;</strong> <sub><em>ì˜¤ë¼í´, ë³´ê³  ìˆë‚˜?</em></sub></p></blockquote><p align=center><img src=images/storage-plan-3.png alt>
<em>PVC ìì²´ë„ 50GBê°€ ìµœì†Œë¼ ë…¸ë“œ 1ê°œ PVC 3ê°œê°€ í•œê³„ì´ë‹¤.</em></p><p><br><br></p><h2 id=í•´ê²°ë°©ì•ˆ>í•´ê²°ë°©ì•ˆ</h2><h3 id=nodepoolì˜-ìŠ¤í™-ë°-ìˆ˜-ì¡°ì •>NodePoolì˜ ìŠ¤í™ ë° ìˆ˜ ì¡°ì •</h3><p>ìš°ì„  Nodeì— 50GBì”© ê¸°ë³¸ í• ë‹¹ ë˜ëŠ” ê±´ ì–´ì©” ë„ë¦¬ê°€ ì—†ê¸° ë•Œë¬¸ì— Node ìˆ˜ë¥¼ íƒ€í˜‘í•´ì•¼ í•œë‹¤.<br>í´ëŸ¬ìŠ¤í„°ë¡œì¨ êµ¬ìƒ‰ì€ ë§ì¶°ì•¼ í•˜ë¯€ë¡œ ê¸°ì¡´ 4ê°œì—ì„œ 2ê°œë¡œ ì¤„ì˜€ë‹¤.<br>ê°ê° CPUëŠ” 2ê°œ, ë©”ëª¨ë¦¬ëŠ” 12GBì”© í• ë‹¹í•´ì¤¬ë‹¤.</p><p align=center><img src=images/instance-list.png alt>
<em>ì´ê±¸ë¡œ ë²Œì¨ 100GBê°€ ë‚ ì•„ê°”ë‹¤</em></p><br><h3 id=ì‹œìŠ¤í…œ-êµ¬ì„±-ìš”ì†Œ>ì‹œìŠ¤í…œ êµ¬ì„± ìš”ì†Œ</h3><p align=center><img src=images/nfs-provisioner.png alt></p><p><a class=link href=https://github.com/kubernetes-sigs/nfs-subdir-external-provisioner target=_blank rel=noopener>NFS Subdir External Provisioner</a>ë¥¼ ì‚¬ìš©í•´ì„œ ë³„ë„ì˜ <code>StorageClass</code>ë¥¼ ë§Œë“¤ì–´ì¤˜ì•¼ í•œë‹¤.</p><p>NFS Storage, ì¦‰ NFS ì„œë²„ë¥¼ Sourceë¡œ í•´ì„œ StorageClassë¥¼ ë§Œë“¤ê³ , í•´ë‹¹ StorageClassë¥¼ í†µí•´ PVCë¥¼ ìƒì„±í•˜ë©´ NFS ì„œë²„ì— ë³¼ë¥¨ì´ ìƒì„±ë˜ê³  ë°ì´í„°ê°€ ì €ì¥ë˜ëŠ” êµ¬ì¡°ì´ë‹¤.</p><p>ì£¼ìš” êµ¬ì„± ìš”ì†Œë¥¼ ë°°í¬ ìˆœì„œì— ë”°ë¼ ë‚˜ì—´í•˜ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.</p><ol><li><p>OCI Block Volume</p><p>ì•ì„œ Node 2ê°œë¥¼ ë°°ì¹˜í–ˆìœ¼ë¯€ë¡œ, ì‚¬ìš© ê°€ëŠ¥í•œ ìš©ëŸ‰ ì œí•œì€ 100GBì´ë‹¤.</p><p align=center><img src=images/block-volume-list.png alt></p><p>ë‚¨ì€ 100GBë¥¼ ëª¨ë‘ ì‚¬ìš©í•˜ëŠ” OCI Block Volume 1ê°œê°€ í•„ìš”í•˜ë‹¤.</p></li><li><p>NFS Server</p><p>1ì—ì„œ ìƒì„±í•œ OCI Block Volumeì„ PVCë¡œ ë§¤í•‘ ë°›ì•„ NFS Storageë¥¼ ì œê³µí•˜ëŠ” ì„œë¹„ìŠ¤ì´ë‹¤.</p></li><li><p>NFS Subdir External Provisioner</p><p>ì´ë²ˆ í¬ìŠ¤íŠ¸ì˜ í•µì‹¬ìœ¼ë¡œ, 2ì—ì„œ ìƒì„±í•œ NFS ì„œë²„ë¥¼ Sourceë¡œ StorageClassë¥¼ ì œê³µí•œë‹¤.</p></li><li><p>(ì„ íƒ) <a class=link href=https://github.com/filebrowser/filebrowser target=_blank rel=noopener>FileBrowser</a>, SFTP Container</p><p>ë³´ë‹¤ í¸í•œ ê´€ë¦¬ë¥¼ ìœ„í•œ ê²ƒìœ¼ë¡œ, ì„ íƒì‚¬í•­ì´ë‹¤.<br>oci-bvê°€ ì œê³µí•˜ëŠ” PVCëŠ” <code>ReadWriteOnce</code> ëª¨ë“œë§Œ ì œê³µë˜ë¯€ë¡œ ë°˜ë“œì‹œ í•˜ë‚˜ì˜ Podì— NFS Containerì™€ í•¨ê»˜ ì •ì˜í•´ì¤˜ì•¼ í•œë‹¤.</p></li></ol><br><br><h3 id=ì‚¬ìš©í•˜ëŠ”-ë„êµ¬>ì‚¬ìš©í•˜ëŠ” ë„êµ¬</h3><ul><li><strong>Terraform</strong>: ì¸í”„ë¼ ìì› ê´€ë¦¬ (OCI ë³¼ë¥¨, ë°±ì—… ì •ì±…)</li><li><strong>Kubernetes Manifests</strong>: NFS ì„œë²„, File Browser, SFTP ì„œë¹„ìŠ¤</li><li><strong>Helm</strong>: NFS Subdir External Provisioner ì„¤ì¹˜</li></ul><blockquote><p>ì‹¤ì œ êµ¬í˜„ì€ CDKTFë¥¼ ì¨ì„œ í•˜ë‚˜ì˜ Stack íŒŒì¼ë¡œ êµ¬ì„±í–ˆë‹¤.</p><p><a class=link href=https://github.com/ApexCaptain/ApexCaptain.IaC/blob/main/src/terraform/stacks/k8s/oke/apps/nfs.stack.ts target=_blank rel=noopener>GitHub ë§í¬</a>ì—ì„œ í™•ì¸ ê°€ëŠ¥í•˜ë‹¤.</p></blockquote><p><br><br></p><h3 id=terraform-ì¸í”„ë¼-êµ¬ì„±>Terraform ì¸í”„ë¼ êµ¬ì„±</h3><p>OCI ì¸í”„ë¼ êµ¬ì„±ì€ <a class=link href=https://registry.terraform.io/providers/oracle/oci/latest target=_blank rel=noopener>Terraform OCI Provider</a>ë¥¼ ì‚¬ìš©í–ˆë‹¤.</p><p>HCL ì½”ë“œì— í”„ë¡œë°”ì´ë”ë¥¼ ì—°ê²°í•˜ëŠ” ê³¼ì •ì€ ì—¬ê¸°ì„  ìƒëµí•œë‹¤. (ì¶”í›„ ë³„ë„ í¬ìŠ¤íŒ… ì˜ˆì •)</p><h4 id=oci-ë¸”ë¡-ë³¼ë¥¨>OCI ë¸”ë¡ ë³¼ë¥¨</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-hcl data-lang=hcl><span class=line><span class=cl><span class=c1># main.tf
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>resource</span> <span class=s2>&#34;oci_core_volume&#34; &#34;nfs_core_volume&#34;</span> {
</span></span><span class=line><span class=cl><span class=n>  compartment_id</span>      <span class=o>=</span> <span class=k>var</span><span class=p>.</span><span class=k>compartment_id</span>
</span></span><span class=line><span class=cl><span class=n>  availability_domain</span> <span class=o>=</span> <span class=k>var</span><span class=p>.</span><span class=k>availability_domain</span>
</span></span><span class=line><span class=cl><span class=n>  size_in_gbs</span>         <span class=o>=</span> <span class=m>100</span>
</span></span><span class=line><span class=cl><span class=n>  display_name</span>        <span class=o>=</span> <span class=s2>&#34;nfs-core-volume&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>lifecycle</span> {
</span></span><span class=line><span class=cl><span class=n>    prevent_destroy</span> <span class=o>=</span> <span class=kt>true</span>
</span></span><span class=line><span class=cl>  }
</span></span><span class=line><span class=cl>}
</span></span></code></pre></td></tr></table></div></div><br><h4 id=ë³¼ë¥¨-ë°±ì—…-ì •ì±…>ë³¼ë¥¨ ë°±ì—… ì •ì±…</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-hcl data-lang=hcl><span class=line><span class=cl><span class=c1># backup_policy.tf
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>resource</span> <span class=s2>&#34;oci_core_volume_backup_policy&#34; &#34;nfs_core_volume_backup_policy&#34;</span> {
</span></span><span class=line><span class=cl><span class=n>  compartment_id</span> <span class=o>=</span> <span class=k>var</span><span class=p>.</span><span class=k>compartment_id</span>
</span></span><span class=line><span class=cl><span class=n>  display_name</span>   <span class=o>=</span> <span class=s2>&#34;nfs-volume-backup-policy&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>schedules</span> {
</span></span><span class=line><span class=cl><span class=n>    backup_type</span>        <span class=o>=</span> <span class=s2>&#34;INCREMENTAL&#34;</span>
</span></span><span class=line><span class=cl><span class=n>    period</span>             <span class=o>=</span> <span class=s2>&#34;ONE_WEEK&#34;</span>
</span></span><span class=line><span class=cl><span class=n>    retention_seconds</span>  <span class=o>=</span> <span class=m>60</span> <span class=err>*</span> <span class=m>60</span> <span class=err>*</span> <span class=m>24</span> <span class=err>*</span> <span class=m>7</span> <span class=err>*</span> <span class=m>3</span><span class=c1>  # 3ì£¼ ë³´ê´€
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>    day_of_week</span>        <span class=o>=</span> <span class=s2>&#34;SUNDAY&#34;</span>
</span></span><span class=line><span class=cl><span class=n>    hour_of_day</span>        <span class=o>=</span> <span class=m>2</span>
</span></span><span class=line><span class=cl><span class=n>    offset_seconds</span>     <span class=o>=</span> <span class=m>0</span>
</span></span><span class=line><span class=cl><span class=n>    offset_type</span>        <span class=o>=</span> <span class=s2>&#34;STRUCTURED&#34;</span>
</span></span><span class=line><span class=cl><span class=n>    time_zone</span>          <span class=o>=</span> <span class=s2>&#34;REGIONAL_DATA_CENTER_TIME&#34;</span>
</span></span><span class=line><span class=cl>  }
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>schedules</span> {
</span></span><span class=line><span class=cl><span class=n>    backup_type</span>        <span class=o>=</span> <span class=s2>&#34;FULL&#34;</span>
</span></span><span class=line><span class=cl><span class=n>    period</span>             <span class=o>=</span> <span class=s2>&#34;ONE_MONTH&#34;</span>
</span></span><span class=line><span class=cl><span class=n>    retention_seconds</span>  <span class=o>=</span> <span class=m>60</span> <span class=err>*</span> <span class=m>60</span> <span class=err>*</span> <span class=m>24</span> <span class=err>*</span> <span class=m>30</span> <span class=err>*</span> <span class=m>2</span><span class=c1>  # 2ê°œì›” ë³´ê´€
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>    day_of_month</span>       <span class=o>=</span> <span class=m>1</span>
</span></span><span class=line><span class=cl><span class=n>    hour_of_day</span>        <span class=o>=</span> <span class=m>3</span>
</span></span><span class=line><span class=cl><span class=n>    offset_seconds</span>     <span class=o>=</span> <span class=m>0</span>
</span></span><span class=line><span class=cl><span class=n>    offset_type</span>        <span class=o>=</span> <span class=s2>&#34;STRUCTURED&#34;</span>
</span></span><span class=line><span class=cl><span class=n>    time_zone</span>          <span class=o>=</span> <span class=s2>&#34;REGIONAL_DATA_CENTER_TIME&#34;</span>
</span></span><span class=line><span class=cl>  }
</span></span><span class=line><span class=cl>}
</span></span></code></pre></td></tr></table></div></div><p><strong>ë°±ì—… ìŠ¤ì¼€ì¤„:</strong></p><ul><li><strong>ì¦ë¶„(INCREMENTAL) ë°±ì—…</strong>: ë§¤ì£¼ ì¼ìš”ì¼ 2ì‹œ, 3ì£¼ ë³´ê´€</li><li><strong>ì „ì²´(FULL) ë°±ì—…</strong>: ë§¤ì›” 1ì¼ 3ì‹œ, 2ê°œì›” ë³´ê´€</li></ul><br><h4 id=ë°±ì—…-ì •ì±…-í• ë‹¹>ë°±ì—… ì •ì±… í• ë‹¹</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-hcl data-lang=hcl><span class=line><span class=cl><span class=c1># backup_policy_assignment.tf
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>resource</span> <span class=s2>&#34;oci_core_volume_backup_policy_assignment&#34; &#34;nfs_core_volume_backup_policy_assignment&#34;</span> {
</span></span><span class=line><span class=cl><span class=n>  asset_id</span>  <span class=o>=</span> <span class=k>oci_core_volume</span><span class=p>.</span><span class=k>nfs_core_volume</span><span class=p>.</span><span class=k>id</span>
</span></span><span class=line><span class=cl><span class=n>  policy_id</span> <span class=o>=</span> <span class=k>oci_core_volume_backup_policy</span><span class=p>.</span><span class=k>nfs_core_volume_backup_policy</span><span class=p>.</span><span class=k>id</span>
</span></span><span class=line><span class=cl>}
</span></span></code></pre></td></tr></table></div></div><br><h4 id=ë³€ìˆ˜-ì •ì˜>ë³€ìˆ˜ ì •ì˜</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-hcl data-lang=hcl><span class=line><span class=cl><span class=c1># variables.tf
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>variable</span> <span class=s2>&#34;compartment_id&#34;</span> {
</span></span><span class=line><span class=cl><span class=n>  description</span> <span class=o>=</span> <span class=s2>&#34;OCI Compartment ID&#34;</span>
</span></span><span class=line><span class=cl><span class=n>  type</span>        <span class=o>=</span> <span class=k>string</span>
</span></span><span class=line><span class=cl>}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>variable</span> <span class=s2>&#34;availability_domain&#34;</span> {
</span></span><span class=line><span class=cl><span class=n>  description</span> <span class=o>=</span> <span class=s2>&#34;OCI Availability Domain&#34;</span>
</span></span><span class=line><span class=cl><span class=n>  type</span>        <span class=o>=</span> <span class=k>string</span> 
</span></span><span class=line><span class=cl>}
</span></span></code></pre></td></tr></table></div></div><br><h4 id=ì¶œë ¥ê°’-ì •ì˜>ì¶œë ¥ê°’ ì •ì˜</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-hcl data-lang=hcl><span class=line><span class=cl><span class=c1># outputs.tf
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>output</span> <span class=s2>&#34;nfs_volume_id&#34;</span> {
</span></span><span class=line><span class=cl><span class=n>  description</span> <span class=o>=</span> <span class=s2>&#34;NFS Core Volume OCID&#34;</span>
</span></span><span class=line><span class=cl><span class=n>  value</span>       <span class=o>=</span> <span class=k>oci_core_volume</span><span class=p>.</span><span class=k>nfs_core_volume</span><span class=p>.</span><span class=k>id</span>
</span></span><span class=line><span class=cl>}
</span></span></code></pre></td></tr></table></div></div><p><code>nfs_volume_id</code> ê°’ì€ PVë¥¼ ë§Œë“¤ ë•Œ í•„ìš”í•˜ë‹¤.</p><br><h4 id=ë³€ìˆ˜-íŒŒì¼-ìƒì„±>ë³€ìˆ˜ íŒŒì¼ ìƒì„±</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cat &gt; terraform.tfvars <span class=s>&lt;&lt; EOF
</span></span></span><span class=line><span class=cl><span class=s>compartment_id      = &#34;&lt; ë°°í¬í•  OCI Compartmentì˜ ID &gt;&#34;
</span></span></span><span class=line><span class=cl><span class=s>availability_domain = &#34;&lt; AD ì´ë¦„, ì˜ˆì‹œ: ibHX:AP-CHUNCHEON-1-AD-1 &gt;&#34;
</span></span></span><span class=line><span class=cl><span class=s>EOF</span>
</span></span></code></pre></td></tr></table></div></div><br><h4 id=terraform-ë°°í¬>Terraform ë°°í¬</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Terraform ì´ˆê¸°í™”</span>
</span></span><span class=line><span class=cl>terraform init
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ì¸í”„ë¼ ê³„íš í™•ì¸</span>
</span></span><span class=line><span class=cl>terraform plan -var-file<span class=o>=</span><span class=s2>&#34;terraform.tfvars&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ì¸í”„ë¼ ë°°í¬</span>
</span></span><span class=line><span class=cl>terraform apply -var-file<span class=o>=</span><span class=s2>&#34;terraform.tfvars&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ì¶œë ¥ê°’ í™•ì¸ (ë³¼ë¥¨ ID ë“±)</span>
</span></span><span class=line><span class=cl>terraform output
</span></span></code></pre></td></tr></table></div></div><p><br><br></p><h3 id=k8s-manifest>k8s Manifest</h3><h4 id=ë„¤ì„ìŠ¤í˜ì´ìŠ¤-ìƒì„±>ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ìƒì„±</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=c># namespace.yaml</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Namespace</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>nfs-system</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><br><h4 id=persistentvolume-ìƒì„±>PersistentVolume ìƒì„±</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=c># persistentvolume.yaml</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>PersistentVolume</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>nfs-pv</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>annotations</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>pv.kubernetes.io/provisioned-by</span><span class=p>:</span><span class=w> </span><span class=l>blockvolume.csi.oraclecloud.com</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>storageClassName</span><span class=p>:</span><span class=w> </span><span class=l>oci-bv</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>persistentVolumeReclaimPolicy</span><span class=p>:</span><span class=w> </span><span class=l>Retain</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>capacity</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>storage</span><span class=p>:</span><span class=w> </span><span class=l>100Gi</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>accessModes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>ReadWriteOnce</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>persistentVolumeSource</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>csi</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>driver</span><span class=p>:</span><span class=w> </span><span class=l>blockvolume.csi.oraclecloud.com</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>volumeHandle</span><span class=p>:</span><span class=w> </span><span class=l>&lt;OCI_VOLUME_OCID&gt;</span><span class=w> </span><span class=c># Terraformì—ì„œ Output ëœ Volume IDê°’ì„ ë„£ì–´ì¤€ë‹¤.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                                      </span><span class=c># ocid1.volume.oc1 ì–´ì©Œêµ¬ í•˜ëŠ” ê°’ì´ë‹¤. Web Consoleì—ì„œ ë³µì‚¬í•´ì„œ ê°€ì ¸ì™€ë„ ëœë‹¤.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>fsType</span><span class=p>:</span><span class=w> </span><span class=l>ext4</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>nodeAffinity</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>required</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>nodeSelectorTerms</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=nt>matchExpressions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=nt>key</span><span class=p>:</span><span class=w> </span><span class=l>failure-domain.beta.kubernetes.io/zone</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>operator</span><span class=p>:</span><span class=w> </span><span class=l>In</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>values</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span>- <span class=l>&lt;AVAILABILITY_DOMAIN&gt;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><br><h4 id=persistentvolumeclaim-ìƒì„±>PersistentVolumeClaim ìƒì„±</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=c># persistentvolumeclaim.yaml</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>PersistentVolumeClaim</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>nfs-pvc</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>namespace</span><span class=p>:</span><span class=w> </span><span class=l>nfs-system</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>volumeName</span><span class=p>:</span><span class=w> </span><span class=l>nfs-pv</span><span class=w> </span><span class=c># ìœ„ì—ì„œ ìƒì„±í•œ PVì˜ ì´ë¦„ì´ë‹¤</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>accessModes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>ReadWriteOnce</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>resources</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>requests</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>storage</span><span class=p>:</span><span class=w> </span><span class=l>100Gi</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>storageClassName</span><span class=p>:</span><span class=w> </span><span class=l>oci-bv</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><br><h4 id=configmap-podì˜-sftp-ì»¨í…Œì´ë„ˆìš©-ssh-í‚¤-ê´€ë¦¬-ì„ íƒì‚¬í•­>ConfigMap (Podì˜ SFTP ì»¨í…Œì´ë„ˆìš© SSH í‚¤ ê´€ë¦¬, ì„ íƒì‚¬í•­)</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=c># configmap.yaml</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>ConfigMap</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>nfs-system-sftp-config</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>namespace</span><span class=p>:</span><span class=w> </span><span class=l>nfs-system</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>data</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>ssh-public-key</span><span class=p>:</span><span class=w> </span><span class=p>|</span><span class=sd>
</span></span></span><span class=line><span class=cl><span class=sd>    ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQ... # SSH ê³µê°œí‚¤</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><br><h4 id=service-ìƒì„±>Service ìƒì„±</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=c># service.yaml</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Service</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>nfs-service</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>namespace</span><span class=p>:</span><span class=w> </span><span class=l>nfs-system</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>selector</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>nfs</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>ports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>nfs</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>port</span><span class=p>:</span><span class=w> </span><span class=m>2049</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>targetPort</span><span class=p>:</span><span class=w> </span><span class=m>2049</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>protocol</span><span class=p>:</span><span class=w> </span><span class=l>TCP</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c># -- ì„ íƒ ì‚¬í•­ -- #</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>file-browser</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>port</span><span class=p>:</span><span class=w> </span><span class=m>8080</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>targetPort</span><span class=p>:</span><span class=w> </span><span class=m>8080</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>protocol</span><span class=p>:</span><span class=w> </span><span class=l>TCP</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>sftp</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>port</span><span class=p>:</span><span class=w> </span><span class=m>22</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>targetPort</span><span class=p>:</span><span class=w> </span><span class=m>22</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>protocol</span><span class=p>:</span><span class=w> </span><span class=l>TCP</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><br><h4 id=deployment-ìƒì„±>Deployment ìƒì„±</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=c># deployment.yaml</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>apps/v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Deployment</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>nfs-deployment</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>namespace</span><span class=p>:</span><span class=w> </span><span class=l>nfs-system</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>replicas</span><span class=p>:</span><span class=w> </span><span class=m>1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>selector</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>matchLabels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>nfs</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>template</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>labels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>nfs</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># FileBrowserë¥¼ ì•ˆ ì“¸ ê±°ë¼ë©´ initContainersëŠ” í•„ìš” ì—†ìŒ   </span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>initContainers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>init-filebrowser-db</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>busybox:1.35</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>command</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=l>/bin/sh</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- -<span class=l>c</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=p>|</span><span class=sd>
</span></span></span><span class=line><span class=cl><span class=sd>              mkdir -p /exports/fb-database
</span></span></span><span class=line><span class=cl><span class=sd>              chown -R 1000:1000 /exports/fb-database
</span></span></span><span class=line><span class=cl><span class=sd>              chmod -R 755 /exports/fb-database</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>volumeMounts</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>nfs-storage</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>mountPath</span><span class=p>:</span><span class=w> </span><span class=l>/exports</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>containers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c># NFS ì„œë²„ ì»¨í…Œì´ë„ˆ (í•µì‹¬!!)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>nfs-server</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>itsthenetwork/nfs-server-alpine:latest-arm</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>imagePullPolicy</span><span class=p>:</span><span class=w> </span><span class=l>Always</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>ports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=nt>containerPort</span><span class=p>:</span><span class=w> </span><span class=m>2049</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>protocol</span><span class=p>:</span><span class=w> </span><span class=l>TCP</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>securityContext</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>capabilities</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>add</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span>- <span class=l>SYS_ADMIN</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span>- <span class=l>SETPCAP</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>command</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=l>/bin/sh</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- -<span class=l>c</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=p>|</span><span class=sd>
</span></span></span><span class=line><span class=cl><span class=sd>              mkdir -p /exports/services
</span></span></span><span class=line><span class=cl><span class=sd>              /usr/bin/nfsd.sh</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>volumeMounts</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>nfs-storage</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>mountPath</span><span class=p>:</span><span class=w> </span><span class=l>/exports</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>env</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>SHARED_DIRECTORY</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=l>/exports</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>SHARED_DIRECTORY_2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=l>/exports/services</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c># File Browser ì»¨í…Œì´ë„ˆ(ì„ íƒ)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>file-browser</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>filebrowser/filebrowser</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>imagePullPolicy</span><span class=p>:</span><span class=w> </span><span class=l>Always</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>ports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=nt>containerPort</span><span class=p>:</span><span class=w> </span><span class=m>8080</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>protocol</span><span class=p>:</span><span class=w> </span><span class=l>TCP</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>securityContext</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>runAsUser</span><span class=p>:</span><span class=w> </span><span class=m>1000</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>runAsGroup</span><span class=p>:</span><span class=w> </span><span class=m>1000</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>fsGroup</span><span class=p>:</span><span class=w> </span><span class=m>1000</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>volumeMounts</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>nfs-storage</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>mountPath</span><span class=p>:</span><span class=w> </span><span class=l>/database</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>subPath</span><span class=p>:</span><span class=w> </span><span class=l>fb-database</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>nfs-storage</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>mountPath</span><span class=p>:</span><span class=w> </span><span class=l>/srv</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>subPath</span><span class=p>:</span><span class=w> </span><span class=l>services</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>env</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>FB_NOAUTH</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;true&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>FB_DATABASE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=l>/database/database.db</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>FB_PORT</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;8080&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c># SFTP ì»¨í…Œì´ë„ˆ(ì„ íƒ)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>sftp-server</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>jmcombs/sftp</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>imagePullPolicy</span><span class=p>:</span><span class=w> </span><span class=l>Always</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>command</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=l>sh</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- -<span class=l>c</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=p>|</span><span class=sd>
</span></span></span><span class=line><span class=cl><span class=sd>              chmod o+w /home/sftpuser/data
</span></span></span><span class=line><span class=cl><span class=sd>              /entrypoint sftpuser::::data</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>ports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=nt>containerPort</span><span class=p>:</span><span class=w> </span><span class=m>22</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>protocol</span><span class=p>:</span><span class=w> </span><span class=l>TCP</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>volumeMounts</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>ssh-keys</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>mountPath</span><span class=p>:</span><span class=w> </span><span class=l>/home/sftpuser/.ssh/keys</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>readOnly</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>nfs-storage</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>mountPath</span><span class=p>:</span><span class=w> </span><span class=l>/home/sftpuser/data</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>subPath</span><span class=p>:</span><span class=w> </span><span class=l>services</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>volumes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>nfs-storage</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>persistentVolumeClaim</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>claimName</span><span class=p>:</span><span class=w> </span><span class=l>nfs-pvc</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>ssh-keys</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>configMap</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>nfs-system-sftp-config</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p><strong>ì»¨í…Œì´ë„ˆë³„ ì—­í• </strong></p><ol><li><strong>NFS ì„œë²„</strong>: Alpine ê¸°ë°˜ NFS ì„œë²„ë¡œ <code>/exports</code> ë””ë ‰í† ë¦¬ ê³µìœ </li><li><strong>File Browser</strong>: ì›¹ ê¸°ë°˜ íŒŒì¼ ê´€ë¦¬ ì¸í„°í˜ì´ìŠ¤ ì œê³µ (ì„ íƒ)</li><li><strong>SFTP ì„œë²„</strong>: SSH í‚¤ ê¸°ë°˜ íŒŒì¼ ì „ì†¡ ì„œë¹„ìŠ¤ (ì„ íƒ)</li></ol><br><h4 id=filebrowser-ingress-êµ¬ì„±-ì„ íƒ>FileBrowser Ingress êµ¬ì„± (ì„ íƒ)</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=c># ingress.yaml</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>networking.k8s.io/v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Ingress</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>nfs-ingress</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>namespace</span><span class=p>:</span><span class=w> </span><span class=l>nfs-system</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>annotations</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>nginx.ingress.kubernetes.io/backend-protocol</span><span class=p>:</span><span class=w> </span><span class=l>HTTP</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>nginx.ingress.kubernetes.io/rewrite-target</span><span class=p>:</span><span class=w> </span><span class=l>/</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>ingressClassName</span><span class=p>:</span><span class=w> </span><span class=l>nginx</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>rules</span><span class=p>:</span><span class=w>   
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>host</span><span class=p>:</span><span class=w> </span><span class=l>files.example.com</span><span class=w> </span><span class=c># ì†Œìœ í•œ ë„ë©”ì¸ìœ¼ë¡œ ë³€ê²½ </span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>http</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>paths</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span>- <span class=nt>path</span><span class=p>:</span><span class=w> </span><span class=l>/</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>pathType</span><span class=p>:</span><span class=w> </span><span class=l>Prefix</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>backend</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>service</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>nfs-service</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nt>port</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                  </span><span class=nt>number</span><span class=p>:</span><span class=w> </span><span class=m>8080</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><br><h4 id=k8s-ë¦¬ì†ŒìŠ¤-ë°°í¬>k8s ë¦¬ì†ŒìŠ¤ ë°°í¬</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ìƒì„±</span>
</span></span><span class=line><span class=cl>kubectl apply -f namespace.yaml
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ConfigMap ìƒì„±</span>
</span></span><span class=line><span class=cl>kubectl apply -f configmap.yaml
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># PersistentVolume ìƒì„±</span>
</span></span><span class=line><span class=cl>kubectl apply -f persistentvolume.yaml
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># PersistentVolumeClaim ìƒì„±</span>
</span></span><span class=line><span class=cl>kubectl apply -f persistentvolumeclaim.yaml
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Service ìƒì„±</span>
</span></span><span class=line><span class=cl>kubectl apply -f service.yaml
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Deployment ìƒì„±</span>
</span></span><span class=line><span class=cl>kubectl apply -f deployment.yaml
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Ingress ìƒì„± (ì„ íƒ)</span>
</span></span><span class=line><span class=cl>kubectl apply -f ingress.yaml
</span></span></code></pre></td></tr></table></div></div><p><br><br></p><h3 id=helm>Helm</h3><h4 id=helm-ì €ì¥ì†Œ-ì¶”ê°€>Helm ì €ì¥ì†Œ ì¶”ê°€</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>helm repo add nfs-subdir-external-provisioner https://kubernetes-sigs.github.io/nfs-subdir-external-provisioner/
</span></span><span class=line><span class=cl>helm repo update
</span></span></code></pre></td></tr></table></div></div><br><h4 id=nfs-subdir-external-provisioner-values-íŒŒì¼>NFS Subdir External Provisioner Values íŒŒì¼</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>nfs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># NFS ì„œë²„ ì„œë¹„ìŠ¤ ì£¼ì†Œ</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># ìœ„ k8s manifestì—ì„œ ìƒì„±í•œ nfs serviceì˜ k8s service dnsë¥¼ ì‚¬ìš©í–ˆë‹¤.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>server</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;nfs-service.nfs-system.svc.cluster.local&#39;</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;/services&#39;</span><span class=w> </span><span class=c># ê³µìœ  ê²½ë¡œ</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># StorageClass ì„¤ì •</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>storageClass</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># StorageClass ì´ë¦„ì€ ë³¸ì¸ì´ ì›í•˜ëŠ”ëŒ€ë¡œ ì‚¬ìš©í•˜ë©´ ëœë‹¤</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>storageClassName</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;nfs-client&#39;</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>accessModes</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;ReadWriteMany&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># PVC í• ë‹¹ ì‹œ Storageì— ì €ì¥ ë  ê²½ë¡œ íŒ¨í„´ì„ ì˜ë¯¸í•œë‹¤.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># ì˜ˆì‹œì˜ ê²½ìš° ./pvc/&lt;ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ëª…&gt;/&lt;PVC ëª…&gt;ìœ¼ë¡œ ì €ì¥ëœë‹¤.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>pathPattern</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;.pvc/${.PVC.namespace}/${.PVC.name}&#39;</span><span class=w> 
</span></span></span></code></pre></td></tr></table></div></div><ul><li>ë³´ë‹¤ êµ¬ì²´ì ì¸ Values ì„¤ì •ì€ <a class=link href=https://github.com/kubernetes-sigs/nfs-subdir-external-provisioner target=_blank rel=noopener>ë‹¤ìŒì˜ ë§í¬</a>ë¥¼ ì°¸ì¡°í•˜ê¸¸ ë°”ë€ë‹¤.</li></ul><br><h4 id=helm-chart-ë°°í¬>Helm Chart ë°°í¬</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>helm install nfs-subdir-external-provisioner nfs-subdir-external-provisioner/nfs-subdir-external-provisioner <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --namespace nfs-system <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --values values.yaml <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --wait
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ì„¤ì¹˜ ìƒíƒœ í™•ì¸</span>
</span></span><span class=line><span class=cl>helm list -n nfs-system
</span></span><span class=line><span class=cl>helm status nfs-subdir-external-provisioner -n nfs-system
</span></span></code></pre></td></tr></table></div></div><p><br><br></p><h3 id=ê²€ì¦-ë°-í…ŒìŠ¤íŠ¸>ê²€ì¦ ë° í…ŒìŠ¤íŠ¸</h3><h4 id=ë¦¬ì†ŒìŠ¤-ìƒíƒœ-í™•ì¸>ë¦¬ì†ŒìŠ¤ ìƒíƒœ í™•ì¸</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Pod ìƒíƒœ í™•ì¸</span>
</span></span><span class=line><span class=cl>kubectl get pods -n nfs-system
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Service í™•ì¸</span>
</span></span><span class=line><span class=cl>kubectl get svc -n nfs-system
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># PVC ìƒíƒœ í™•ì¸</span>
</span></span><span class=line><span class=cl>kubectl get pvc -n nfs-system
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># StorageClass í™•ì¸</span>
</span></span><span class=line><span class=cl>kubectl get storageclass
</span></span></code></pre></td></tr></table></div></div><p><br><br></p><h2 id=ë§ˆì¹˜ë©°>ë§ˆì¹˜ë©°</h2><p>ì´ì œ ë‹¤ë¥¸ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì—ì„œ PVCë¥¼ ìƒì„±í•´ë³´ì.</p><p>FileBrowserì™€ ingressê¹Œì§€ ì„¤ì •í–ˆë‹¤ë©´ ì›¹ìƒìœ¼ë¡œ ì ‘ê·¼í•´ì„œ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p><p>ingressê°€ ë³„ë„ë¡œ ì—†ë‹¤ë©´ ë‹¤ìŒ ëª…ë ¹ì–´ë¡œ í¬íŠ¸í¬ì›Œë”©í•´ì„œ <code>localhost:8080</code>ìœ¼ë¡œ ì ‘ê·¼í•´ë³´ì.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl port-forward --address localhost -n nfs-system svc/nfs-service 8080:8080
</span></span></code></pre></td></tr></table></div></div><p align=center><img src=images/cover.png alt>
<em>PVCê°€ ì§€ì •ëœ ê²½ë¡œ (.pvc/namespace/pvc-name)ì— ìƒì„±ë¨ì„ ì•Œ ìˆ˜ ìˆë‹¤.</em></p><p><br><br></p><h2 id=ì¶”í›„-ê³„íš>ì¶”í›„ ê³„íš</h2><p>í˜„ì¬ k8s í´ëŸ¬ìŠ¤í„°ì— <a class=link href=https://www.hashicorp.com/en/products/vault target=_blank rel=noopener>Vault</a>ê°€ ë°°í¬ë˜ì–´ ìˆëŠ”ë°, Nodeì˜ ìˆ˜ê°€ 2ê°œë¿ì´ë¼ HA (High-Availability) êµ¬ì„±ì´ ì•ˆ ë˜ê³  ìˆë‹¤. (ìµœì†Œ 3ê°œ ì´ìƒ í•„ìš”)</p><p>NFS ProvisionerëŠ” ì™¸ë¶€ì— ì¡´ì¬í•˜ëŠ” NFS Storageë¥¼ ì‚¬ìš©í•  ìˆ˜ë„ ìˆìœ¼ë¯€ë¡œ, NASìš© ì»´í“¨í„° í•œ ëŒ€ë¥¼ êµ¬ë§¤í•´ì„œ NFS ì„œë²„ë¥¼ êµ¬ì¶•í•œ ë’¤ NFS Provisionerì˜ Sourceë¡œ í™œìš©í•  ì˜ˆì •ì´ë‹¤.</p><p>ì´ëŠ” ë˜ ë‹¤ë¥¸ í´ëŸ¬ìŠ¤í„°ì¸ On-Premiseì—ë„ ì ìš©ë  ì˜ˆì •ì´ë‹¤. On-Premise í´ëŸ¬ìŠ¤í„°ëŠ” <a class=link href=https://longhorn.io/ target=_blank rel=noopener>Longhorn</a>ì„ ì„¤ì¹˜í•´ì„œ PVCë¥¼ ì œê³µí•˜ê³  ìˆëŠ”ë°, ì´ë˜ì €ë˜ ë§ˆìŒì— ì•ˆ ë“œëŠ” êµ¬ì„ì´ ë§ì•„ ì‹¬í”Œí•˜ê²Œ ì™¸ë¶€ NASë¡œ í†µí•©í•˜ë ¤ê³  í•œë‹¤.</p><p>Longhornì— ëŒ€í•´ì„œëŠ” ì¡°ë§Œê°„ í¬ìŠ¤íŒ…í•  ì˜ˆì •ì´ë‹¤.</p></section><footer class=article-footer><section class=article-tags><a href=/tags/kubernetes/>Kubernetes</a>
<a href=/tags/oci/>OCI</a>
<a href=/tags/nfs/>NFS</a>
<a href=/tags/storageclass/>StorageClass</a>
<a href=/tags/pvc/>PVC</a></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>ê´€ë ¨ ê¸€</h2><div class=related-content><div class="flex article-list--tile"><article class=has-image><a href=/p/dev/install-windows-on-k8s/><div class=article-image><img src=/p/dev/install-windows-on-k8s/images/cover.d6b8cebf4b682d596e1913abd1653322_hu_684629e7f31a1126.png width=250 height=150 loading=lazy alt="Featured image of post k8sì— Windows ì„¤ì¹˜í•˜ê¸°" data-key=dev/install-windows-on-k8s data-hash="md5-1rjOv0toLVluGROr0WUzIg=="></div><div class=article-details><h2 class=article-title>k8sì— Windows ì„¤ì¹˜í•˜ê¸°</h2></div></a></article><article class=has-image><a href=/p/dev/oracle-cloud-infrastructure/><div class=article-image><img src=/p/dev/oracle-cloud-infrastructure/images/cover.4030afd137330bedd307626b3dc3deac_hu_14c2f933114c7fc2.png width=250 height=150 loading=lazy alt="Featured image of post Oracle Cloud Infrastructure" data-key=dev/oracle-cloud-infrastructure data-hash="md5-QDCv0TczC+3TB2JrPcPerA=="></div><div class=article-details><h2 class=article-title>Oracle Cloud Infrastructure</h2></div></a></article><article class=has-image><a href=/p/dev/install-metallb-to-on-premise-k8s/><div class=article-image><img src=/p/dev/install-metallb-to-on-premise-k8s/images/cover.2c0e356b72e9a7a9380e959e98ea4e20_hu_605c6a090051f8f9.png width=250 height=150 loading=lazy alt="Featured image of post On-Premise k8sì— Metallb ì„¤ì¹˜" data-key=dev/install-metallb-to-on-premise-k8s data-hash="md5-LA41a3Lpp6k4DpWemOpOIA=="></div><div class=article-details><h2 class=article-title>On-Premise k8sì— Metallb ì„¤ì¹˜</h2></div></a></article><article class=has-image><a href=/p/dev/torrenting-with-vpn-on-k8s/><div class=article-image><img src=/p/dev/torrenting-with-vpn-on-k8s/images/cover.c665819bfcbea04dd3d62876855e0077_hu_6cecdffce5d986eb.png width=250 height=150 loading=lazy alt="Featured image of post VPN + qBittorrent ì„¤ì¹˜" data-key=dev/torrenting-with-vpn-on-k8s data-hash="md5-xmWBm/y+oE3T1ih2hV4Adw=="></div><div class=article-details><h2 class=article-title>VPN + qBittorrent ì„¤ì¹˜</h2></div></a></article><article class=has-image><a href=/p/dev/apexcaptain.iac/><div class=article-image><img src=/p/dev/apexcaptain.iac/images/cover.40c934e95067ba2660ba6c01253006a7_hu_2d81731f87a0c06.png width=250 height=150 loading=lazy alt="Featured image of post ApexCaptain.IaC" data-key=dev/apexcaptain.iac data-hash="md5-QMk06VBnuiZgumwBJTAGpw=="></div><div class=article-details><h2 class=article-title>ApexCaptain.IaC</h2></div></a></article></div></div></aside><script src=https://utteranc.es/client.js repo=ApexCaptain/ApexCaptain.github.io issue-term=pathname label=comments crossorigin=anonymous async></script><style>.utterances{max-width:unset}</style><script>let utterancesLoaded=!1;function setUtterancesTheme(e){let t=document.querySelector(".utterances iframe");t&&t.contentWindow.postMessage({type:"set-theme",theme:`github-${e}`},"https://utteranc.es")}addEventListener("message",e=>{if(e.origin!=="https://utteranc.es")return;utterancesLoaded=!0,setUtterancesTheme(document.documentElement.dataset.scheme)}),window.addEventListener("onColorSchemeChange",e=>{if(!utterancesLoaded)return;setUtterancesTheme(e.detail)})</script><footer class=site-footer><section class=copyright>&copy;
2025 ApexCaptainì˜ ê¸°ìˆ  ë¸”ë¡œê·¸</section><section class=powerby><a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a>ë¡œ ë§Œë“¦<br><a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a>ì˜ <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.31.0>Stack</a></b> í…Œë§ˆ ì‚¬ìš© ì¤‘</section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>